#!/bin/bash
# agent-flow-prompt - Prompt for workflow actions on lifecycle events
# Usage: agent-flow-prompt <event>
# Called by tmux hooks

# Get current workflow state
STATE=$(agent-flow-state get 2>/dev/null || echo "IDLE")

case "${1:-}" in
    detach)
        # Called when client detaches from session
        # Log state for reference (no notification)
        if [[ "$STATE" != "IDLE" && "$STATE" != "DONE" ]]; then
            echo "[agent-flow] Detached with active workflow: $STATE"
        fi
        ;;

    idle)
        # Called when pane has been idle for a while
        # Log suggestion (no notification)
        suggestion=$(agent-flow-state suggest 2>/dev/null || echo "")
        if [ -n "$suggestion" ]; then
            echo "[agent-flow] Idle suggestion: $suggestion"
        fi
        ;;

    activity)
        # Called when there's activity in a pane
        # Could be used to track state transitions automatically
        ;;

    *)
        # Show current state info
        echo "Workflow: $STATE"
        agent-flow-state suggest 2>/dev/null || true
        ;;
esac
