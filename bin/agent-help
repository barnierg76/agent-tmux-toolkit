#!/bin/bash
# agent-help - Quick reference for agent-tmux-toolkit
set -e

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
DIM='\033[2m'
BOLD='\033[1m'
NC='\033[0m'

show_usage() {
    cat << 'EOF'
agent-help - Quick reference for agent-tmux-toolkit

USAGE:
    agent-help [options]

OPTIONS:
    --help, -h    Show this help message
    --keys        Show only keyboard shortcuts
    --commands    Show only commands

EXAMPLES:
    agent-help           # Show full help
    agent-help --keys    # Show keyboard shortcuts only
EOF
}

show_keys() {
    cat << 'EOF'
===============================================================
 KEYBOARD SHORTCUTS
===============================================================
 Option+S        Snippet picker (context-aware)
 Option+Space    Snippet picker (alternate)
 Option+M        Agent manager menu
 Option+F        Flow orchestrator
 Option+H        Handoff between panes
 Option+D        Status dashboard
 Option+1/2/3    Jump to pane 1/2/3
 Option+Arrows   Navigate between panes
 Option+</>      Swap panes left/right
 Option+Backspace Clear current line
 Option+?        This help screen
===============================================================
EOF
}

show_commands() {
    cat << 'EOF'
===============================================================
 COMMANDS
===============================================================
 agent-session   Create new agent session (3-pane layout)
 agent-manage    Interactive session manager
 agent-flow      Workflow orchestrator (plan/work/review)
 agent-handoff   Transfer context between panes
 agent-status    View agent status dashboard
 agent-worktree  Git worktree management
 agent-delegate  Spawn parallel agents
 agent-notify    Desktop notifications
 snippet-picker  Open snippet picker
 snippet-edit    Edit snippets file in $EDITOR
===============================================================
EOF
}

show_snippets() {
    cat << 'EOF'
===============================================================
 SNIPPET PICKER NAVIGATION
===============================================================
 Enter           Select snippet/folder
 <- (Left arrow) Go back to folders / Cancel
 ESC             Cancel completely
 Type            Filter snippets by name
 ?               Show this help
===============================================================
 CONTEXT DETECTION
===============================================================
 In PLAN pane:   Shows PLAN, EVERY, HANDOFF snippets
 In WORK pane:   Shows WORK, EVERY, QUICK snippets
 In REVIEW pane: Shows REVIEW, EVERY snippets

 Select "Browse All Folders" for full folder view
===============================================================
EOF
}

show_full_help() {
    echo -e "${BOLD}+===============================================================+${NC}"
    echo -e "${BOLD}|              AGENT TMUX TOOLKIT - QUICK REFERENCE             |${NC}"
    echo -e "${BOLD}+===============================================================+${NC}"
    echo
    show_keys
    echo
    show_commands
    echo
    show_snippets
    echo
    echo -e "${DIM}Press q or ESC to close${NC}"
}

case "${1:-}" in
    --help|-h)
        show_usage
        exit 0
        ;;
    --keys)
        show_keys
        exit 0
        ;;
    --commands)
        show_commands
        exit 0
        ;;
    *)
        if [[ -n "${TMUX:-}" ]]; then
            show_full_help | less -R
        else
            show_full_help
        fi
        ;;
esac
